<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>External Validation of logistic prediction models in 
 multiply imputed datasets — mivalext_lr • psfmi</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="External Validation of logistic prediction models in 
 multiply imputed datasets — mivalext_lr"><meta property="og:description" content="mivalext_lr External validation of logistic prediction models"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psfmi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Pool_Model_Performance.html">Pool Model Performance</a>
    </li>
    <li>
      <a href="../articles/Pooling_AUC_values.html">Pooling AUC values</a>
    </li>
    <li>
      <a href="../articles/psfmi_CoxModels.html">Pooling and Selection of Cox Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_LinearModels.html">Pooling and Selection of Linear Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_LogisticModels.html">Pooling and Selection of Logistic Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_mice.html">Working together: mice and psfmi</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mwheymans/psfmi/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>External Validation of logistic prediction models in 
 multiply imputed datasets</h1>
    <small class="dont-index">Source: <a href="https://github.com/mwheymans/psfmi/blob/HEAD/R/mivalext_lr.R" class="external-link"><code>R/mivalext_lr.R</code></a></small>
    <div class="hidden name"><code>mivalext_lr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>mivalext_lr</code> External validation of logistic prediction models</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mivalext_lr</span><span class="op">(</span></span>
<span>  data.val <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data.orig <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nimp <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  impvar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lp.orig <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cal.plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">plot.indiv</span>,</span>
<span>  val.check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  g <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  groups_cal <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot.method <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data.val</dt>
<dd><p>Data frame with stacked multiply imputed validation datasets.
The original dataset that contains missing values must be excluded from the
dataset. The imputed datasets must be distinguished by an imputation variable,
specified under impvar, and starting by 1.</p></dd>


<dt>data.orig</dt>
<dd><p>A single data frame containing the original dataset
that was used to develop the model. Used to estimate the original regression
coefficients in case lp.orig is not provided.</p></dd>


<dt>nimp</dt>
<dd><p>A numerical scalar. Number of imputed datasets. Default is 5.</p></dd>


<dt>impvar</dt>
<dd><p>A character vector. Name of the variable that distinguishes the
imputed datasets.</p></dd>


<dt>formula</dt>
<dd><p>A formula object to specify the model as normally used by glm.</p></dd>


<dt>lp.orig</dt>
<dd><p>Numeric vector of the original coefficient values that are
externally validated.</p></dd>


<dt>cal.plot</dt>
<dd><p>If TRUE a calibration plot is generated. Default is FALSE.</p></dd>


<dt>plot.indiv</dt>
<dd><p>This argument is deprecated; please use plot.method instead.</p></dd>


<dt>val.check</dt>
<dd><p>logical vector. If TRUE the names of the predictors of the LP
are provided and can be used as information for the order of the coefficient
values as input for lp.orig. If FALSE (default) validation procedure is executed
with coefficient values fitted in the order as used under lp.orig.</p></dd>


<dt>g</dt>
<dd><p>A numerical scalar. Number of groups for the Hosmer and
Lemeshow test. Default is 10.</p></dd>


<dt>groups_cal</dt>
<dd><p>A numerical scalar. Number of groups used on the calibration plot. 
Default is 10. If the range of predicted probabilities is low, less than 10 groups 
can be chosen.</p></dd>


<dt>plot.method</dt>
<dd><p>If "mean" one calibration plot is generated, first taking the 
mean of the linear predictor values across the multiply imputed datasets (default), if 
"individual" the calibration plot in each imputed dataset is plotted, 
if "overlay" calibration plots from each imputed datasets are plotted in one figure.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>mivalext_lr</code> object from which the following objects 
 can be extracted: <code>calibrate</code> with information about 
 mis-calibration in intercept and slope with and without offset procedure,</p>
<p></p>
<p><code>coef_pooled</code>, coefficients pooled, ROC results as <code>ROC</code>, 
 R squared results as <code>R2</code>, Hosmer and Lemeshow test as <code>HL_test</code>,</p>
<p></p>
<p><code>nimp</code>, <code>formula</code>, <code>impvar</code>, <code>val.check</code>, <code>g</code>,</p>
<p></p>
<p><code>coef.check</code> and <code>groups_cal</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The following information of the externally validated model is provided:
 <code>calibrate</code> with information of <code>pooled_int</code> and <code>pooled_slope</code> that is
 the pooled linear predictor (LP), after the LP is freely estimated in each external imputed 
 dataset <code>Outcome ~ a + LP</code> (provides information about miscalibration in intercept 
 and slope), <code>pooled_offset_int</code> as <code>Outcome ~ a + offset(LP)</code> and 
 <code>pooled_offset_slope</code> as <code>Outcome ~ a + LP + offset(LP)</code> with information 
 about miscalibration in intercept and slope separately by using an offset procedure 
 (see Steyerberg, p. 300), <code>coef_pooled</code> with the pooled coefficients when the model 
 is freely estimated in imputed datasets, <code>ROC</code> pooled ROC curve (back transformed 
 after pooling log transformed ROC curves), <code>R2</code> pooled Nagelkerke R-Square value 
 (back transformed after pooling Fisher transformed values), <code>HLtest</code> pooled Hosmer 
 and Lemeshow Test (using function <code>pool_D2</code>). In addition information is provided about 
 <code>nimp</code>, <code>impvar</code>, <code>formula</code>, <code>val_ckeck</code>, <code>g</code> and <code>coef_check</code>. 
 When the external validation is very poor, the R2 can become negative due to the poor fit of 
 the model in the external dataset (in that case you may report a R2 of zero).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>F. Harrell. Regression Modeling Strategies. With Applications to
 Linear Models, Logistic and Ordinal Regression, and Survival Analysis. 2nd Edition.
 Springer, New York, NY, 2015.</p>
<p>EW. Steyerberg (2019). Clinical Prediction MOdels. A Practical Approach
 to Development, Validation, and Updating (2nd edition). Springer Nature Switzerland AG.</p>
<p>Van Buuren S. (2018). Flexible Imputation of Missing Data. 2nd Edition. Chapman &amp;
 Hall/CRC Interdisciplinary Statistics. Boca Raton.</p>
<p>http://missingdatasolutions.rbind.io/</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">mivalext_lr</span><span class="op">(</span>data.val<span class="op">=</span><span class="va">lbpmilr</span>, nimp<span class="op">=</span><span class="fl">5</span>, impvar<span class="op">=</span><span class="st">"Impnr"</span>, </span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">Chronic</span> <span class="op">~</span> <span class="va">Gender</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Carrying</span><span class="op">)</span>  <span class="op">+</span> <span class="va">Function</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>  <span class="va">Tampascale</span> <span class="op">+</span> <span class="va">Age</span>, lp.orig<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">0.35</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="op">-</span><span class="fl">0.04</span>, <span class="fl">0.26</span>, <span class="op">-</span><span class="fl">0.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cal.plot<span class="op">=</span><span class="cn">TRUE</span>, val.check <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Pooled performance measures over m = 5 imputed external validation datasets</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>             correctly estimated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="mivalext_lr-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $calibrate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       Estimate   95% CI L  95% CI U     P-val</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled_int          -0.0788081 -0.4838591 0.3262428 0.7012108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled_slope         0.9818332  0.6645742 1.2990921 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled_offset_int   -0.0768418 -0.4836964 0.3300127 0.7095419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled_offset_slope -0.0181668 -0.3354258 0.2990921 0.9098709</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coef_pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       (Intercept)            Gender factor(Carrying)2 factor(Carrying)3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -9.66084          -0.41365           0.92735           1.05231 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Function        Tampascale               Age </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          -0.03579           0.25232          -0.01235 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ROC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     95% Low C-statistic 95% Up</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C-statistic (logit)  0.7854      0.8551 0.9048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $R2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.46333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $HLtest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      F_value   P(&gt;F) df1        df2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.10684 0.99901   8 3977692743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nimp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $impvar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Impnr"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $formula</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chronic ~ Gender + factor(Carrying) + Function + Tampascale + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x563b0b2727c0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $val_check</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $g</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $coef_check</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "(Intercept)"       "Gender"            "factor(Carrying)2"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "factor(Carrying)3" "Function"          "Tampascale"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "Age"              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $groups_cal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martijn Heymans.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

