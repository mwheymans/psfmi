<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prediction Model Selection and Performance Evaluation in Multiple Imputed Datasets • psfmi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Prediction Model Selection and Performance Evaluation in Multiple Imputed Datasets">
<meta property="og:description" content="
	Pooling, backward and forward selection of logistic and Cox regression models in 
	multiply imputed datasets. Backward and forward selection can be done 
	from the pooled model using Rubin's Rules (RR), the D1, D2, D3 and 
	the median p-values method. This is also possible for Mixed models. 
	The models can contain continuous, dichotomous, categorical and restricted 
	cubic spline predictors and interaction terms between	all these type of predictors. 
	The stability of the models	can be evaluated using bootstrapping and cluster 
	bootstrapping. The package further contains functions to pool the model performance 
	as ROC/AUC, R-squares, scaled Brier score and calibration	plots for logistic 
	regression models. Internal validation can be	done with cross-validation or bootstrapping. 
	The adjusted intercept after shrinkage of pooled regression coefficients can be obtained. 
	Backward and forward selection as part of internal validation is possible. 
	A function to externally validate logistic prediction models in multiple imputed 
	datasets is available and a function to compare models.
	Eekhout (2017) &lt;doi:10.1186/s12874-017-0404-7&gt;.
	Wiel (2009) &lt;doi:10.1093/biostatistics/kxp011&gt;.
	Marshall (2009) &lt;doi:10.1186/1471-2288-9-57&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">psfmi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/MI_boot.html">Multiple Imputation and Bootstrapping - Method MI_boot</a>
    </li>
    <li>
      <a href="articles/MI_cv_naive.html">Multiple Imputation and Cross-validation - The MI_cv_naive method</a>
    </li>
    <li>
      <a href="articles/boot_MI.html">Multiple Imputation and Bootstrapping - Method boot_MI</a>
    </li>
    <li>
      <a href="articles/cv_MI.html">Multiple Imputation and Cross-validation - method cv_MI</a>
    </li>
    <li>
      <a href="articles/cv_MI_RR.html">Multiple Imputation and Cross-validation - Method cv_MI_RR</a>
    </li>
    <li>
      <a href="articles/development_workflow.html">Workflow to Develop and Validate a Prediction model in Multiply Imputed data</a>
    </li>
    <li>
      <a href="articles/psfmi_CoxModels.html">Pooling and Selection of Cox Regression Models</a>
    </li>
    <li>
      <a href="articles/psfmi_LogisticModels.html">Pooling and Selection of Logistic Regression Models</a>
    </li>
    <li>
      <a href="articles/psfmi_StabilityAnalysis.html">Stability analysis after Multiple Imputation</a>
    </li>
    <li>
      <a href="articles/psfmi_mice.html">Working together: mice and psfmi</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mwheymans/psfmi/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="psfmi" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#psfmi" class="anchor"></a>psfmi</h1></div>

<p>The package provides functions to apply pooling, backward and forward selection of logistic and Cox regression prediction models in multiply imputed data sets using Rubin’s Rules (RR), the D1, D2, D3 and the median p-values method. The model can contain continuous, dichotomous, categorical and restricted cubic spline predictors and interaction terms between all these type of predictors.</p>
<p>Validation of the prediction models can be performed with cross-validation or bootstrapping in multiply imputed data sets and pooled model performance measures as AUC value, R-square, scaled Brier score and calibration plots are generated. Also a function to externally validate logistic prediction models in multiple imputed data sets is available and a function to compare models in multiply imputed data.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of psfmi with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"psfmi"</span><span class="op">)</span></code></pre></div>
<p>And the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mwheymans/psfmi"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This example shows you how to apply forward selection with a model that includes a restricted cubic spline function and an interaction term.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mwheymans.github.io/psfmi/">psfmi</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'car':</span>
<span class="co">#&gt;   method                          from</span>
<span class="co">#&gt;   influence.merMod                lme4</span>
<span class="co">#&gt;   cooks.distance.influence.merMod lme4</span>
<span class="co">#&gt;   dfbeta.influence.merMod         lme4</span>
<span class="co">#&gt;   dfbetas.influence.merMod        lme4</span>

<span class="va">pool_lr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/psfmi_lr.html">psfmi_lr</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">lbpmilr</span>, formula <span class="op">=</span> <span class="va">Chronic</span> <span class="op">~</span> <span class="fu">rcs</span><span class="op">(</span><span class="va">Pain</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="va">JobDemands</span> <span class="op">+</span> <span class="fu">rcs</span><span class="op">(</span><span class="va">Tampascale</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
                   <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Satisfaction</span><span class="op">)</span> <span class="op">+</span> <span class="va">Smoking</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Satisfaction</span><span class="op">)</span><span class="op">*</span><span class="fu">rcs</span><span class="op">(</span><span class="va">Pain</span>, <span class="fl">3</span><span class="op">)</span> ,
                   p.crit <span class="op">=</span> <span class="fl">0.05</span>, direction<span class="op">=</span><span class="st">"FW"</span>, nimp<span class="op">=</span><span class="fl">5</span>, impvar<span class="op">=</span><span class="st">"Impnr"</span>,
                   method<span class="op">=</span><span class="st">"D1"</span><span class="op">)</span>
<span class="co">#&gt; Entered at Step 1 is - rcs(Pain,3)</span>
<span class="co">#&gt; Entered at Step 2 is - factor(Satisfaction)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Selection correctly terminated, </span>
<span class="co">#&gt; No new variables entered the model</span>
<span class="va">pool_lr</span><span class="op">$</span><span class="va">RR_model_final</span>
<span class="co">#&gt; $`Final model`</span>
<span class="co">#&gt;                    term   estimate std.error  statistic        df     p.value</span>
<span class="co">#&gt; 1           (Intercept) -3.6027668 1.5427414 -2.3353018  60.25659 0.022875170</span>
<span class="co">#&gt; 2 factor(Satisfaction)2 -0.4725289 0.5164342 -0.9149838 145.03888 0.361718841</span>
<span class="co">#&gt; 3 factor(Satisfaction)3 -2.3328994 0.7317131 -3.1882707 122.95905 0.001815476</span>
<span class="co">#&gt; 4      rcs(Pain, 3)Pain  0.6514983 0.4028728  1.6171315  51.09308 0.112008088</span>
<span class="co">#&gt; 5     rcs(Pain, 3)Pain'  0.4703811 0.4596490  1.0233483  75.29317 0.309419924</span>
<span class="co">#&gt;           OR   lower.EXP upper.EXP</span>
<span class="co">#&gt; 1 0.02724823 0.001245225 0.5962503</span>
<span class="co">#&gt; 2 0.62342367 0.224644070 1.7301016</span>
<span class="co">#&gt; 3 0.09701406 0.022793375 0.4129150</span>
<span class="co">#&gt; 4 1.91841309 0.854476033 4.3070942</span>
<span class="co">#&gt; 5 1.60060402 0.640677978 3.9987846</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=psfmi">https://​cloud.r-project.org/​package=psfmi</a>
</li>
<li>Browse source code at <br><a href="https://github.com/mwheymans/psfmi/">https://​github.com/​mwheymans/​psfmi/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mwheymans/psfmi/issues/%20">https://​github.com/​mwheymans/​psfmi/​issues/​ </a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Martijn Heymans <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-3889-0921" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=psfmi"><img src="https://www.r-pkg.org/badges/version-ago/psfmi" alt="CRAN_Release_Badge"></a></li>
<li><a href="https://CRAN.R-project.org/package=psfmi"><img src="https://cranlogs.r-pkg.org/badges/last-month/psfmi?color=blue" alt="Monthly downloads badge"></a></li>
<li><a href="https://travis-ci.org/mwheymans/psfmi"><img src="https://travis-ci.com/mwheymans/psfmi.svg?branch=master" alt="Travis Build Status"></a></li>
<li><a href="https://cran.r-project.org/"><img src="https://img.shields.io/badge/R%3E%3D-4.0.0-6666ff.svg" alt="minimal R version"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Martijn Heymans.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
