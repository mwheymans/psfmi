<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>External Validation of logistic prediction models in 
 multiply imputed datasets — mivalext_lr • psfmi</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="External Validation of logistic prediction models in 
 multiply imputed datasets — mivalext_lr" />
<meta property="og:description" content="mivalext_lr External validation of logistic prediction models" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psfmi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/boot_MI.html">Multiple Imputation and Bootstrapping - Method boot_MI</a>
    </li>
    <li>
      <a href="../articles/cv_MI.html">Multiple Imputation and Cross-validation - method cv_MI</a>
    </li>
    <li>
      <a href="../articles/cv_MI_RR.html">Multiple Imputation and Cross-validation - Method cv_MI_RR</a>
    </li>
    <li>
      <a href="../articles/MI_boot.html">Multiple Imputation and Bootstrapping - Method MI_boot</a>
    </li>
    <li>
      <a href="../articles/MI_cv_naive.html">Multiple Imputation and Cross-validation - The MI_cv_naive method</a>
    </li>
    <li>
      <a href="../articles/psfmi_CoxModels.html">Pooling and Selection of Cox Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_LogisticModels.html">Pooling and Selection of Logistic Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_mice.html">Working together: mice and psfmi</a>
    </li>
    <li>
      <a href="../articles/psfmi_StabilityAnalysis.html">Stability analysis after Multiple Imputation</a>
    </li>
    <li>
      <a href="../articles/psfmi_valext.html">Workflow to Develop and Validate a Prediction model with `mice` and `psfmi`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mwheymans/psfmi/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>External Validation of logistic prediction models in 
 multiply imputed datasets</h1>
    <small class="dont-index">Source: <a href='https://github.com/mwheymans/psfmi/blob/master/R/mivalext_lr.R'><code>R/mivalext_lr.R</code></a></small>
    <div class="hidden name"><code>mivalext_lr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>mivalext_lr</code> External validation of logistic prediction models</p>
    </div>

    <pre class="usage"><span class='fu'>mivalext_lr</span>(
  <span class='kw'>data.val</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>data.orig</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>nimp</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>impvar</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>Outcome</span>,
  <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>lp.orig</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cal.plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>plot.indiv</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>val.check</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>g</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>groups_cal</span> <span class='kw'>=</span> <span class='fl'>10</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data.val</th>
      <td><p>Data frame with stacked multiply imputed validation datasets.
The original dataset that contains missing values must be excluded from the
dataset. The imputed datasets must be distinguished by an imputation variable,
specified under impvar, and starting by 1.</p></td>
    </tr>
    <tr>
      <th>data.orig</th>
      <td><p>A single data frame containing the original dataset
that was used to develop the model. Used to estimate the original regression
coefficients in case lp.orig is not provided.</p></td>
    </tr>
    <tr>
      <th>nimp</th>
      <td><p>A numerical scalar. Number of imputed datasets. Default is 5.</p></td>
    </tr>
    <tr>
      <th>impvar</th>
      <td><p>A character vector. Name of the variable that distinguishes the
imputed datasets.</p></td>
    </tr>
    <tr>
      <th>Outcome</th>
      <td><p>Character vector containing the name of the outcome variable.</p></td>
    </tr>
    <tr>
      <th>predictors</th>
      <td><p>Character vector with the names of the predictor variables
of the model that is validated.</p></td>
    </tr>
    <tr>
      <th>lp.orig</th>
      <td><p>Numeric vector of the original coefficient values that are
externally validated.</p></td>
    </tr>
    <tr>
      <th>cal.plot</th>
      <td><p>If TRUE a calibration plot is generated. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>plot.indiv</th>
      <td><p>If TRUE calibration plots of each imputed dataset are
generated. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>val.check</th>
      <td><p>logical vector. If TRUE the names of the predictors of the LP
are provided and can be used as information for the order of the coefficient
values as input for lp.orig. If FALSE (default) validation procedure is executed
with coefficient values fitted in the order as used under lp.orig.</p></td>
    </tr>
    <tr>
      <th>g</th>
      <td><p>A numerical scalar. Number of groups for the Hosmer and
Lemeshow test. Default is 10.</p></td>
    </tr>
    <tr>
      <th>groups_cal</th>
      <td><p>A numerical scalar. Number of groups used on the calibration plot. 
Default is 10. If the range of predicted probabilities is low, less than 10 groups 
can be chosen.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>mivalext_lr</code> object from which the following objects 
 can be extracted: ROC results as <code>ROC</code>, R squared results (fixed and calibrated) 
 as <code>R2 (fixed)</code> and <code>R2 (calibr)</code>, Hosmer and Lemeshow test as <code>HL_test</code>, 
 coefficients pooled as <code>coef_pooled</code>, linear predictor pooled as <code>LP_pooled ext</code>, 
 and <code>Outcome</code>, <code>nimp</code>, <code>impvar</code>, <code>val.check</code>, 
 <code>g</code>, <code>coef.check</code> and <code>groups_cal</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The following information of the externally validated model is provided:
 <code>ROC</code> pooled ROC curve (median and back transformed after pooling log transformed
 ROC curves), <code>R2_fixed</code> and <code>R2_calibr</code> pooled Nagelkerke R-Square value 
 (median and back transformed after pooling Fisher transformed values), <code>HLtest</code> 
 pooled Hosmer and Lemeshow Test (using miceadds package), <code>coef_pooled</code> pooled 
 coefficients when model is freely estimated in imputed datasets and <code>LP_pooled_ext</code> 
 the pooled linear predictor (LP), after the externally validated LP is estimated in 
 each imputed dataset (provides information about miscalibration in intercept and slope). 
 In addition information is provided about <code>nimp</code>, <code>impvar</code>, <code>Outcome</code>,
 <code>val_ckeck</code>, <code>g</code> and <code>coef_check</code>. When the external validation is 
 very poor, the R2 fixed can become negative due to the poor fit of the model in
 the external dataset (in that case you may report a R2 of zero).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>F. Harrell. Regression Modeling Strategies. With Applications to
 Linear Models, Logistic and Ordinal Regression, and Survival Analysis. 2nd Edition.
 Springer, New York, NY, 2015.</p>
<p>Van Buuren S. (2018). Flexible Imputation of Missing Data. 2nd Edition. Chapman &amp;
 Hall/CRC Interdisciplinary Statistics. Boca Raton.</p>
<p>http://missingdatasolutions.rbind.io/</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>mivalext_lr</span>(<span class='kw'>data.val</span><span class='kw'>=</span><span class='no'>lbpmilr</span>, <span class='kw'>nimp</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>impvar</span><span class='kw'>=</span><span class='st'>"Impnr"</span>, <span class='kw'>Outcome</span><span class='kw'>=</span><span class='st'>"Chronic"</span>,
<span class='kw'>predictors</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Gender"</span>, <span class='st'>"factor(Carrying)"</span>, <span class='st'>"Function"</span>, <span class='st'>"Tampascale"</span>, <span class='st'>"Age"</span>),
<span class='kw'>lp.orig</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>10</span>, -<span class='fl'>0.35</span>, <span class='fl'>1.00</span>, <span class='fl'>1.00</span>, -<span class='fl'>0.04</span>, <span class='fl'>0.26</span>, -<span class='fl'>0.01</span>),
<span class='kw'>cal.plot</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>plot.indiv</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>val.check</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Pooled performance measures over m = 5 imputed external validation datasets correctly estimated</span>
#&gt; <span class='message'></span></div><div class='img'><img src='mivalext_lr-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; $ROC
#&gt; $ROC$`ROC (logit)`
#&gt;             95% Low     ROC  95% Up
#&gt; ROC (logit) 0.69344 0.85507 0.93898
#&gt; 
#&gt; $ROC$`ROC (median)`
#&gt; 1st Qu.  Median 3rd Qu. 
#&gt; 0.85491 0.85620 0.85789 
#&gt; 
#&gt; 
#&gt; $R2_fixed
#&gt; $R2_fixed$`Fisher Z (fixed)`
#&gt; [1] 0.46333
#&gt; 
#&gt; $R2_fixed$`Median (fixed)`
#&gt; 1st Qu.  Median 3rd Qu. 
#&gt; 0.46254 0.46506 0.47510 
#&gt; 
#&gt; 
#&gt; $R2_calibr
#&gt; $R2_calibr$`Fisher Z (calibrated)`
#&gt; [1] 0.46465
#&gt; 
#&gt; $R2_calibr$`Median (calibrated)`
#&gt; 1st Qu.  Median 3rd Qu. 
#&gt; 0.46309 0.46562 0.47609 
#&gt; 
#&gt; 
#&gt; $HLtest
#&gt;        D        p       df      df2 
#&gt;  1.11778  0.37425  8.00000 36.86064 
#&gt; 
#&gt; $coef_pooled
#&gt;       (Intercept)            Gender factor(Carrying)2 factor(Carrying)3 
#&gt;          -9.66084          -0.41365           0.92735           1.05231 
#&gt;          Function        Tampascale               Age 
#&gt;          -0.03579           0.25232          -0.01235 
#&gt; 
#&gt; $LP_pooled_ext
#&gt; (Intercept)      lp.ext 
#&gt;    -0.07881     0.98183 
#&gt; 
#&gt; $nimp
#&gt; [1] 5
#&gt; 
#&gt; $impvar
#&gt; [1] "Impnr"
#&gt; 
#&gt; $Outcome
#&gt; [1] "Chronic"
#&gt; 
#&gt; $val_check
#&gt; [1] FALSE
#&gt; 
#&gt; $g
#&gt; [1] 10
#&gt; 
#&gt; $coef_check
#&gt; [1] "(Intercept)"       "Gender"            "factor(Carrying)2"
#&gt; [4] "factor(Carrying)3" "Function"          "Tampascale"       
#&gt; [7] "Age"              
#&gt; 
#&gt; $groups_cal
#&gt; [1] 10
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Martijn Heymans.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


