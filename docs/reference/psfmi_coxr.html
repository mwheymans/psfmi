<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pooling and Predictor selection function for backward or forward selection of
Cox regression models across multiply imputed data. — psfmi_coxr • psfmi</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pooling and Predictor selection function for backward or forward selection of
Cox regression models across multiply imputed data. — psfmi_coxr"><meta property="og:description" content="psfmi_coxr Pooling and backward or forward selection of Cox regression
prediction models in multiply imputed data using selection methods D1, D2 and MPR."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psfmi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Pooling_AUC_values.html">Pooling AUC values</a>
    </li>
    <li>
      <a href="../articles/Pool_Model_Performance.html">Pool Model Performance</a>
    </li>
    <li>
      <a href="../articles/psfmi_CoxModels.html">Pooling and Selection of Cox Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_LinearModels.html">Pooling and Selection of Linear Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_LogisticModels.html">Pooling and Selection of Logistic Regression Models</a>
    </li>
    <li>
      <a href="../articles/psfmi_mice.html">Working together: mice and psfmi</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mwheymans/psfmi/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pooling and Predictor selection function for backward or forward selection of
Cox regression models across multiply imputed data.</h1>
    <small class="dont-index">Source: <a href="https://github.com/mwheymans/psfmi/blob/HEAD/R/psfmi_coxr.R" class="external-link"><code>R/psfmi_coxr.R</code></a></small>
    <div class="hidden name"><code>psfmi_coxr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>psfmi_coxr</code> Pooling and backward or forward selection of Cox regression
prediction models in multiply imputed data using selection methods D1, D2 and MPR.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">psfmi_coxr</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nimp <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  impvar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">status</span>,</span>
<span>  predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cat.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spline.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  int.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata.variable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nknots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.crit <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>  direction <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Data frame with stacked multiple imputed datasets.
The original dataset that contains missing values must be excluded from the
dataset. The imputed datasets must be distinguished by an imputation variable,
specified under impvar, and starting by 1.</p></dd>


<dt>formula</dt>
<dd><p>A formula object to specify the model as normally used by coxph.
See under "Details" and "Examples" how these can be specified. If a formula
object is used set predictors, cat.predictors, spline.predictors or int.predictors
at the default value of NULL.</p></dd>


<dt>nimp</dt>
<dd><p>A numerical scalar. Number of imputed datasets. Default is 5.</p></dd>


<dt>impvar</dt>
<dd><p>A character vector. Name of the variable that distinguishes the
imputed datasets.</p></dd>


<dt>time</dt>
<dd><p>Survival time.</p></dd>


<dt>status</dt>
<dd><p>The status variable, normally 0=censoring, 1=event.</p></dd>


<dt>predictors</dt>
<dd><p>Character vector with the names of the predictor variables.
At least one predictor variable has to be defined. Give predictors unique names
and do not use predictor name combinations with numbers as, age2, gnder10, etc.</p></dd>


<dt>cat.predictors</dt>
<dd><p>A single string or a vector of strings to define the
categorical variables. Default is NULL categorical predictors.</p></dd>


<dt>spline.predictors</dt>
<dd><p>A single string or a vector of strings to define the
(restricted cubic) spline variables. Default is NULL spline predictors. See details.</p></dd>


<dt>int.predictors</dt>
<dd><p>A single string or a vector of strings with the names of the variables that form
an interaction pair, separated by a “:” symbol.</p></dd>


<dt>keep.predictors</dt>
<dd><p>A single string or a vector of strings including the variables that are forced
in the model during predictor selection. Categorical and interaction variables are allowed.</p></dd>


<dt>strata.variable</dt>
<dd><p>A single string including the strata variable. See under "Details" 
and "Examples" how such a variable can be specified.</p></dd>


<dt>nknots</dt>
<dd><p>A numerical vector that defines the number of knots for each spline predictor separately.</p></dd>


<dt>p.crit</dt>
<dd><p>A numerical scalar. P-value selection criterion. A value of 1
provides the pooled model without selection.</p></dd>


<dt>method</dt>
<dd><p>A character vector to indicate the pooling method for p-values to pool the
total model or used during predictor selection. This can be "RR", D1", "D2", or "MPR".
See details for more information. Default is "RR".</p></dd>


<dt>direction</dt>
<dd><p>The direction of predictor selection, "BW" means backward selection and "FW"
means forward selection.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>pmods</code> (multiply imputed models) from
 which the following objects can be extracted:</p>
<p></p>
<ul><li><p><code>data</code> imputed datasets</p></li>
<li><p><code>RR_model</code> pooled model at each selection step</p></li>
<li><p><code>RR_model_final</code> final selected pooled model</p></li>
<li><p><code>multiparm</code> pooled p-values at each step according to pooling method</p></li>
<li><p><code>multiparm_final</code> pooled p-values at final step according to pooling method</p></li>
<li><p><code>multiparm_out</code> (only when direction = "FW") pooled p-values of removed predictors</p></li>
<li><p><code>formula_step</code> formula object at each step</p></li>
<li><p><code>formula_final</code> formula object at final step</p></li>
<li><p><code>formula_initial</code> formula object at final step</p></li>
<li><p><code>predictors_in</code> predictors included at each selection step</p></li>
<li><p><code>predictors_out</code> predictors excluded at each step</p></li>
<li><p><code>impvar</code> name of variable used to distinguish imputed datasets</p></li>
<li><p><code>nimp</code> number of imputed datasets</p></li>
<li><p><code>status</code> name of the status variable</p></li>
<li><p><code>time</code> name of the time variable</p></li>
<li><p><code>method</code> selection method</p></li>
<li><p><code>p.crit</code> p-value selection criterium</p></li>
<li><p><code>call</code> function call</p></li>
<li><p><code>model_type</code> type of regression model used</p></li>
<li><p><code>direction</code> direction of predictor selection</p></li>
<li><p><code>predictors_final</code> names of predictors in final selection step</p></li>
<li><p><code>predictors_initial</code> names of predictors in start model</p></li>
<li><p><code>keep.predictors</code> names of predictors that were forced in the model</p></li>
<li><p><code>strata.variable</code> names of the strata variable in the model</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The basic pooling procedure to derive pooled coefficients, standard errors, 95
 confidence intervals and p-values is Rubin's Rules (RR). However, RR is only possible when
 the model included continuous or dichotomous variables. Specific procedures are
 available when the model also included categorical (&gt; 2 categories) or restricted cubic spline
 variables. These pooling methods are: “D1” is pooling of the total covariance matrix,
 ”D2” is pooling of Chi-square values and “MPR” is pooling of median p-values (MPR rule).
 Spline regression coefficients are defined by using the rcs function for restricted cubic
 splines of the rms package. A minimum number of 3 knots as defined under knots is required.</p>
<p>A typical formula object has the form <code>Surv(time, status) ~ terms</code>. Categorical variables has to
 be defined as <code>Surv(time, status) ~ factor(variable)</code>, restricted cubic spline variables as
 <code>Surv(time, status) ~ rcs(variable, 3)</code>. Interaction terms can be defined as
 <code>Surv(time, status) ~ variable1*variable2</code> or <code>Surv(time, status) ~ variable1 + variable2 + 
 variable1:variable2</code>. All variables in the terms part have to be separated by a "+". If a formula
 object is used set predictors, cat.predictors, spline.predictors or int.predictors
 at the default value of NULL. For Cox models also a strata variable is allowed to include in 
 the formula as <code>Surv(time, status) ~ strata(variable) + terms</code>.</p>
    </div>
    <div id="vignettes">
    <h2>Vignettes</h2>
    

<p>https://mwheymans.github.io/psfmi/articles/psfmi_CoxModels.html</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Eekhout I, van de Wiel MA, Heymans MW. Methods for significance testing of categorical
  covariates in logistic regression models after multiple imputation: power and applicability
  analysis. BMC Med Res Methodol. 2017;17(1):129.</p>
<p>Enders CK (2010). Applied missing data analysis. New York: The Guilford Press.</p>
<p>van de Wiel MA, Berkhof J, van Wieringen WN. Testing the prediction error difference between
  2 predictors. Biostatistics. 2009;10:550-60.</p>
<p>Marshall A, Altman DG, Holder RL, Royston P. Combining estimates of interest in prognostic
  modelling studies after multiple imputation: current practice and guidelines. BMC Med Res Methodol.
  2009;9:57.</p>
<p>Van Buuren S. (2018). Flexible Imputation of Missing Data. 2nd Edition. Chapman &amp; Hall/CRC
  Interdisciplinary Statistics. Boca Raton.</p>
<p>EW. Steyerberg (2019). Clinical Prediction MOdels. A Practical Approach
 to Development, Validation, and Updating (2nd edition). Springer Nature Switzerland AG.</p>
<p>http://missingdatasolutions.rbind.io/</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Martijn Heymans, 2020</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="va">pool_coxr</span> <span class="op">&lt;-</span> <span class="fu">psfmi_coxr</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Status</span><span class="op">)</span> <span class="op">~</span> <span class="va">Pain</span> <span class="op">+</span> <span class="va">Tampascale</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                       <span class="va">Radiation</span> <span class="op">+</span> <span class="va">Radiation</span><span class="op">*</span><span class="va">Pain</span> <span class="op">+</span> <span class="va">Age</span> <span class="op">+</span> <span class="va">Duration</span> <span class="op">+</span> <span class="va">Previous</span>,</span></span>
<span class="r-in"><span>                     data<span class="op">=</span><span class="va">lbpmicox</span>, p.crit <span class="op">=</span> <span class="fl">0.05</span>, direction<span class="op">=</span><span class="st">"BW"</span>, nimp<span class="op">=</span><span class="fl">5</span>, impvar<span class="op">=</span><span class="st">"Impnr"</span>,</span></span>
<span class="r-in"><span>                     keep.predictors <span class="op">=</span> <span class="st">"Radiation*Pain"</span>, method<span class="op">=</span><span class="st">"D1"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed at Step 1 is - Previous</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed at Step 2 is - Age</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed at Step 3 is - Tampascale</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selection correctly terminated, </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No more variables removed from the model</span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span> <span class="va">pool_coxr</span><span class="op">$</span><span class="va">RR_model_final</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Step 4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             term     estimate   std.error   statistic       df    p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           Pain -0.106402350 0.053609346 -1.98477238 114.6369 0.04955832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      Radiation  0.034402970 0.614625339  0.05597389 100.6917 0.95547353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       Duration -0.007502183 0.003758976 -1.99580506 184.2603 0.04742814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Pain:Radiation -0.026253904 0.088245839 -0.29750869  98.0881 0.76670736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          HR lower.EXP upper.EXP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.8990628 0.8084829  0.999791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.0350016 0.3057787  3.503280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.9925259 0.9851924  0.999914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.9740877 0.8176075  1.160516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">pool_coxr</span> <span class="op">&lt;-</span> <span class="fu">psfmi_coxr</span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Status</span><span class="op">)</span> <span class="op">~</span> <span class="va">Pain</span> <span class="op">+</span> <span class="va">Tampascale</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                       <span class="va">Previous</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html" class="external-link">strata</a></span><span class="op">(</span><span class="va">Radiation</span><span class="op">)</span>, data<span class="op">=</span><span class="va">lbpmicox</span>, p.crit <span class="op">=</span> <span class="fl">0.05</span>, </span></span>
<span class="r-in"><span>                       direction<span class="op">=</span><span class="st">"BW"</span>, nimp<span class="op">=</span><span class="fl">5</span>, impvar<span class="op">=</span><span class="st">"Impnr"</span>, method<span class="op">=</span><span class="st">"D1"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed at Step 1 is - Previous</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed at Step 2 is - Tampascale</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selection correctly terminated, </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No more variables removed from the model</span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span> <span class="va">pool_coxr</span><span class="op">$</span><span class="va">RR_model_final</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Step 3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term   estimate  std.error statistic       df     p.value        HR lower.EXP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Pain -0.1126181 0.04173645 -2.698315 163.6317 0.007700164 0.8934918 0.8228104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   upper.EXP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.970245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martijn Heymans.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

