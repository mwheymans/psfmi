<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="psfmi_mm Pooling and backward selection for 2 level (generalized)
linear mixed models in multiply imputed datasets using different selection methods."><title>Pooling and Predictor selection function for multilevel
models in multiply imputed datasets — psfmi_mm • psfmi</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pooling and Predictor selection function for multilevel
models in multiply imputed datasets — psfmi_mm"><meta property="og:description" content="psfmi_mm Pooling and backward selection for 2 level (generalized)
linear mixed models in multiply imputed datasets using different selection methods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">psfmi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/boot_MI.html">Multiple Imputation and Bootstrapping - Method boot_MI</a>
    <a class="dropdown-item" href="../articles/Pooling_AUC_values.html">Pooling AUC values</a>
    <a class="dropdown-item" href="../articles/Pool_Model_Performance.html">Pool Model Performance</a>
    <a class="dropdown-item" href="../articles/psfmi_CoxModels.html">Pooling and Selection of Cox Regression Models</a>
    <a class="dropdown-item" href="../articles/psfmi_LinearModels.html">Pooling and Selection of Linear Regression Models</a>
    <a class="dropdown-item" href="../articles/psfmi_LogisticModels.html">Pooling and Selection of Logistic Regression Models</a>
    <a class="dropdown-item" href="../articles/psfmi_mice.html">Working together: mice and psfmi</a>
    <a class="dropdown-item" href="../articles/psfmi_StabilityAnalysis.html">Stability analysis after Multiple Imputation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mwheymans/psfmi/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Pooling and Predictor selection function for multilevel
models in multiply imputed datasets</h1>
      <small class="dont-index">Source: <a href="https://github.com/mwheymans/psfmi/blob/HEAD/R/psfmi_mm.R" class="external-link"><code>R/psfmi_mm.R</code></a></small>
      <div class="d-none name"><code>psfmi_mm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>psfmi_mm</code> Pooling and backward selection for 2 level (generalized)
linear mixed models in multiply imputed datasets using different selection methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">psfmi_mm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  nimp <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  impvar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusvar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">Outcome</span>,</span>
<span>  predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  random.eff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  p.crit <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cat.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spline.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  int.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep.predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nknots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>  print.method <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Data frame with stacked multiple imputed datasets.
The original dataset that contains missing values must be excluded from the
dataset. The imputed datasets must be distinguished by an imputation variable,
specified under impvar, and starting by 1 and the clusters should be 
distinguished by a cluster variable, specified under clusvar.</p></dd>


<dt>nimp</dt>
<dd><p>A numerical scalar. Number of imputed datasets. Default is 5.</p></dd>


<dt>impvar</dt>
<dd><p>A character vector. Name of the variable that distinguishes the
imputed datasets.</p></dd>


<dt>clusvar</dt>
<dd><p>A character vector. Name of the variable that distinguishes the
clusters.</p></dd>


<dt>Outcome</dt>
<dd><p>Character vector containing the name of the outcome variable.</p></dd>


<dt>predictors</dt>
<dd><p>Character vector with the names of the predictor variables.
At least one predictor variable has to be defined.</p></dd>


<dt>random.eff</dt>
<dd><p>Character vector to specify the random effects as used by the 
<code>lmer</code> and <code>glmer</code> functions of the <code>lme4</code> package.</p></dd>


<dt>family</dt>
<dd><p>Character vector to specify the type of model, "linear" is used to 
call the <code>lmer</code> function and "binomial" is used to call the <code>glmer</code>
function of the <code>lme4</code> package. See details for more information.</p></dd>


<dt>p.crit</dt>
<dd><p>A numerical scalar. P-value selection criterium. A value of 1 
provides the pooled model without selection.</p></dd>


<dt>cat.predictors</dt>
<dd><p>A single string or a vector of strings to define the
categorical variables. Default is NULL categorical predictors.</p></dd>


<dt>spline.predictors</dt>
<dd><p>A single string or a vector of strings to define the
(restricted cubic) spline variables. Default is NULL spline predictors. See details.</p></dd>


<dt>int.predictors</dt>
<dd><p>A single string or a vector of strings with the names of the 
variables that form an interaction pair, separated by a “:” symbol.</p></dd>


<dt>keep.predictors</dt>
<dd><p>A single string or a vector of strings including the variables that are forced
in the model during predictor selection. Categorical and interaction variables are allowed.</p></dd>


<dt>nknots</dt>
<dd><p>A numerical vector that defines the number of knots for each spline predictor separately.</p></dd>


<dt>method</dt>
<dd><p>A character vector to indicate the pooling method for p-values to pool the
total model or used during predictor selection. This can be "D1", "D2", "D3" or "MPR".
See details for more information.</p></dd>


<dt>print.method</dt>
<dd><p>logical vector. If TRUE full matrix with p-values of all variables according to
chosen method (under method) is shown. If FALSE (default) p-value for categorical variables according
to method are shown and for continuous and dichotomous predictors Rubin’s Rules are used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>smodsmi</code> (selected models in multiply imputed datasets) from 
 which the following objects can be extracted: imputed datasets as <code>data</code>, selected 
 pooled model as <code>RR_model</code>, pooled p-values according to pooling method as <code>multiparm</code>, 
 random effects as <code>random.eff</code>, predictors included at each selection step as <code>predictors_in</code>, 
 predictors excluded at each step as <code>predictors_out</code>, and <code>family</code>, <code>impvar</code>, <code>clusvar</code>,</p>
<p></p>
<p><code>nimp</code>, <code>Outcome</code>, <code>method</code>, <code>p.crit</code>, <code>predictors</code>, <code>cat.predictors</code>,</p>
<p></p>
<p><code>keep.predictors</code>, <code>int.predictors</code>, <code>spline.predictors</code>, <code>knots</code>, <code>print.method</code>,</p>
<p></p>
<p><code>model_type</code>, <code>call</code>, <code>predictors_final</code> for names of predictors in final step and</p>
<p></p>
<p><code>fit.formula</code> is the regression formula of start model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The basic pooling procedure to derive pooled coefficients, standard errors, 95
 confidence intervals and p-values is Rubin's Rules (RR). Specific procedures are
 available to derive pooled p-values for categorical (&gt; 2 categories) and spline variables.
 print.method allows to choose between the pooling methods: D1, D2 and D3 and MPR for pooling of 
 median p-values (MPR rule). The D1, D2 and D3 methods are called from the package <code>mitml</code>.
 For Logistic multilevel models (that are estimated using the <code>glmer</code> function), the D3 method
 is not yet available. Spline regression coefficients are defined by using the rcs function for 
 restricted cubic splines of the rms package. A minimum number of 3 knots as defined under knots is required.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Eekhout I, van de Wiel MA, Heymans MW. Methods for significance testing of categorical
  covariates in logistic regression models after multiple imputation: power and applicability
  analysis. BMC Med Res Methodol. 2017;17(1):129.</p>
<p>Enders CK (2010). Applied missing data analysis. New York: The Guilford Press.</p>
<p>Meng X-L, Rubin DB. Performing likelihood ratio tests with multiply-imputed data sets.
  Biometrika.1992;79:103-11.</p>
<p>van de Wiel MA, Berkhof J, van Wieringen WN. Testing the prediction error difference between
  2 predictors. Biostatistics. 2009;10:550-60.</p>
<p>mitml package https://cran.r-project.org/web/packages/mitml/index.html</p>
<p>Van Buuren S. (2018). Flexible Imputation of Missing Data. 2nd Edition. Chapman &amp; Hall/CRC
  Interdisciplinary Statistics. Boca Raton.</p>
<p>http://missingdatasolutions.rbind.io/</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">pool_mm</span> <span class="op">&lt;-</span> <span class="fu">psfmi_mm</span><span class="op">(</span>data<span class="op">=</span><span class="va">ipdna_md</span>, nimp<span class="op">=</span><span class="fl">5</span>, impvar<span class="op">=</span><span class="st">".imp"</span>, family<span class="op">=</span><span class="st">"linear"</span>,</span></span>
<span class="r-in"><span>  predictors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"afib"</span>, <span class="st">"sbp"</span><span class="op">)</span>, clusvar <span class="op">=</span> <span class="st">"centre"</span>,</span></span>
<span class="r-in"><span>  random.eff<span class="op">=</span><span class="st">"( 1 | centre)"</span>, Outcome<span class="op">=</span><span class="st">"dbp"</span>, cat.predictors <span class="op">=</span> <span class="st">"bmi_cat"</span>,</span></span>
<span class="r-in"><span>  p.crit<span class="op">=</span><span class="fl">0.15</span>, method<span class="op">=</span><span class="st">"D1"</span>, print.method <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pool_mm</span><span class="op">$</span><span class="va">RR_Model</span></span></span>
<span class="r-in"><span>  <span class="va">pool_mm</span><span class="op">$</span><span class="va">multiparm</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Martijn Heymans.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

